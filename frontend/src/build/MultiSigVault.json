{
  "contractName": "MultiSigVault",
  "constructorInputs": [
    {
      "name": "owner0",
      "type": "pubkey"
    },
    {
      "name": "owner1",
      "type": "pubkey"
    },
    {
      "name": "owner2",
      "type": "pubkey"
    },
    {
      "name": "minerFeeSats",
      "type": "int"
    },
    {
      "name": "emergencyPubkey",
      "type": "pubkey"
    },
    {
      "name": "emergencyUnlockTime",
      "type": "int"
    }
  ],
  "abi": [
    {
      "name": "spend",
      "inputs": [
        {
          "name": "s0",
          "type": "sig"
        },
        {
          "name": "s1",
          "type": "sig"
        },
        {
          "name": "amountSats",
          "type": "int"
        }
      ]
    },
    {
      "name": "emergencyWithdraw",
      "inputs": [
        {
          "name": "emergencySig",
          "type": "sig"
        }
      ]
    },
    {
      "name": "receiveFunds",
      "inputs": []
    }
  ],
  "bytecode": "OP_6 OP_PICK OP_0 OP_NUMEQUAL OP_IF OP_7 OP_PICK OP_OVER OP_CHECKSIG OP_9 OP_PICK OP_3 OP_PICK OP_CHECKSIG OP_BOOLAND OP_8 OP_PICK OP_2 OP_PICK OP_CHECKSIG OP_10 OP_PICK OP_5 OP_PICK OP_CHECKSIG OP_BOOLAND OP_BOOLOR OP_8 OP_PICK OP_3 OP_PICK OP_CHECKSIG OP_10 OP_PICK OP_3 OP_PICK OP_CHECKSIG OP_BOOLAND OP_BOOLOR OP_8 OP_PICK OP_3 OP_PICK OP_CHECKSIG OP_10 OP_PICK OP_5 OP_PICK OP_CHECKSIG OP_BOOLAND OP_BOOLOR OP_8 OP_PICK OP_4 OP_PICK OP_CHECKSIG OP_10 OP_PICK OP_3 OP_ROLL OP_CHECKSIG OP_BOOLAND OP_BOOLOR OP_7 OP_ROLL OP_3 OP_ROLL OP_CHECKSIG OP_7 OP_ROLL OP_3 OP_ROLL OP_CHECKSIG OP_BOOLAND OP_BOOLOR OP_VERIFY OP_INPUTINDEX OP_UTXOVALUE OP_2DUP OP_LESSTHAN OP_VERIFY OP_SWAP OP_SUB OP_TXOUTPUTCOUNT OP_1 OP_GREATERTHANOREQUAL OP_VERIFY OP_0 OP_OUTPUTVALUE OP_5 OP_PICK OP_NUMEQUALVERIFY OP_DUP OP_5 OP_PICK OP_NUMEQUAL OP_IF OP_TXOUTPUTCOUNT OP_1 OP_NUMEQUALVERIFY OP_ELSE OP_TXOUTPUTCOUNT OP_2 OP_NUMEQUALVERIFY OP_1 OP_OUTPUTBYTECODE OP_ACTIVEBYTECODE OP_EQUALVERIFY OP_1 OP_OUTPUTVALUE OP_OVER OP_6 OP_PICK OP_SUB OP_NUMEQUALVERIFY OP_ENDIF OP_2DROP OP_2DROP OP_DROP OP_1 OP_ELSE OP_6 OP_PICK OP_1 OP_NUMEQUAL OP_IF OP_TXLOCKTIME OP_6 OP_ROLL OP_GREATERTHANOREQUAL OP_VERIFY OP_6 OP_ROLL OP_5 OP_ROLL OP_CHECKSIGVERIFY OP_INPUTINDEX OP_UTXOVALUE OP_DUP OP_5 OP_PICK OP_GREATERTHAN OP_VERIFY OP_4 OP_ROLL OP_SUB OP_TXOUTPUTCOUNT OP_1 OP_GREATERTHANOREQUAL OP_VERIFY OP_0 OP_OUTPUTVALUE OP_NUMEQUALVERIFY OP_2DROP OP_2DROP OP_1 OP_ELSE OP_6 OP_ROLL OP_2 OP_NUMEQUALVERIFY OP_1 OP_VERIFY OP_2DROP OP_2DROP OP_2DROP OP_1 OP_ENDIF OP_ENDIF",
  "source": "pragma cashscript ^0.12.0;\n\n/*\n  MultiSigVault.cash\n  - Constructor:\n      pubkey[] owners,\n      int threshold,\n      int minerFeeSats,\n      pubkey emergencyPubkey,\n      int emergencyUnlockTime\n  - Functions:\n      spend(sig[] sigs, pubkey recipient, int amountSats)\n      emergencyWithdraw(sig emergencySig, pubkey recipient)\n      receiveFunds()\n  Notes:\n    - Backend must assemble at least `threshold` valid signatures in `sigs`.\n    - Active input must be set to the contract UTXO.\n    - Sum(outputs) == inputVal - minerFeeSats.\n*/\n\ncontract MultiSigVault(pubkey owner0, pubkey owner1, pubkey owner2, int minerFeeSats, pubkey emergencyPubkey, int emergencyUnlockTime) {\n\n  // Supports 2-of-3 multisig using explicit signature parameters (s0,s1).\n  function spend(sig s0, sig s1, int amountSats) {\n    bool valid = (checkSig(s0, owner0) && checkSig(s1, owner1))\n                 || (checkSig(s0, owner0) && checkSig(s1, owner2))\n                 || (checkSig(s0, owner1) && checkSig(s1, owner0))\n                 || (checkSig(s0, owner1) && checkSig(s1, owner2))\n                 || (checkSig(s0, owner2) && checkSig(s1, owner0))\n                 || (checkSig(s0, owner2) && checkSig(s1, owner1));\n    require(valid);\n\n    int inputVal = tx.inputs[this.activeInputIndex].value;\n    require(inputVal > minerFeeSats);\n    int distributable = inputVal - minerFeeSats;\n\n    require(tx.outputs.length >= 1);\n    require(tx.outputs[0].value == amountSats);\n\n    // No loops allowed; enforce either single output == distributable, or recipient + change back to contract\n    if (distributable == amountSats) {\n      require(tx.outputs.length == 1);\n    } else {\n      require(tx.outputs.length == 2);\n      require(tx.outputs[1].lockingBytecode == this.activeBytecode);\n      require(tx.outputs[1].value == distributable - amountSats);\n    }\n  }\n\n  function emergencyWithdraw(sig emergencySig) {\n    require(tx.locktime >= emergencyUnlockTime);\n    require(checkSig(emergencySig, emergencyPubkey));\n\n    int inputVal = tx.inputs[this.activeInputIndex].value;\n    require(inputVal > minerFeeSats);\n    int distributable = inputVal - minerFeeSats;\n\n    require(tx.outputs.length >= 1);\n    require(tx.outputs[0].value == distributable);\n  }\n\n  function receiveFunds() {\n    // Accept deposits\n    require(true);\n  }\n}\n",
  "debug": {
    "bytecode": "5679009c63577978ac59795379ac9a58795279ac5a795579ac9a9b58795379ac5a795379ac9a9b58795379ac5a795579ac9a9b58795479ac5a79537aac9a9b577a537aac577a537aac9a9b69c0c66e9f697c94c451a26900cc55799d7655799c63c4519d67c4529d51cdc18851cc785679949d686d6d7551675679519c63c5567aa269567a557aadc0c6765579a069547a94c451a26900cc9d6d6d5167567a529d51696d6d6d516868",
    "sourceMap": "24:2:48:3;;;;;25:27:25:29;;:31::37;:18::38:1;:51::53:0;;:55::61;;:42::62:1;:18;26:30:26:32:0;;:34::40;;:21::41:1;:54::56:0;;:58::64;;:45::65:1;:21;25:17::66;27:30:27:32:0;;:34::40;;:21::41:1;:54::56:0;;:58::64;;:45::65:1;:21;25:17::66;28:30:28:32:0;;:34::40;;:21::41:1;:54::56:0;;:58::64;;:45::65:1;:21;25:17::66;29:30:29:32:0;;:34::40;;:21::41:1;:54::56:0;;:58::64;;:45::65:1;:21;25:17::66;30:30:30:32:0;;:34::40;;:21::41:1;:54::56:0;;:58::64;;:45::65:1;:21;25:17::66;31:4:31:19;33:29:33:50:0;:19::57:1;34:12:34:35:0;::::1;:4::37;35:35:35:47:0;:24:::1;37:12:37:29:0;:33::34;:12:::1;:4::36;38:23:38:24:0;:12::31:1;:35::45:0;;:4::47:1;41:8:41:21:0;:25::35;;:8:::1;:37:43:5:0;42:14:42:31;:35::36;:6::38:1;43:11:47:5:0;44:14:44:31;:35::36;:6::38:1;45:25:45:26:0;:14::43:1;:47::66:0;:6::68:1;46:25:46:26:0;:14::33:1;:37::50:0;:53::63;;:37:::1;:6::65;43:11:47:5;24:2:48:3;;;;;50::60::0;;;;;51:12:51:23;:27::46;;:12:::1;:4::48;52:21:52:33:0;;:35::50;;:4::53:1;54:29:54:50:0;:19::57:1;55:12:55:20:0;:23::35;;:12:::1;:4::37;56:35:56:47:0;;:24:::1;58:12:58:29:0;:33::34;:12:::1;:4::36;59:23:59:24:0;:12::31:1;:4::50;50:2:60:3;;;;62::65::0;;;;64:12:64:16;:4::18:1;62:2:65:3;;;;21:0:66:1;",
    "logs": [],
    "requires": [
      {
        "ip": 81,
        "line": 31
      },
      {
        "ip": 86,
        "line": 34
      },
      {
        "ip": 92,
        "line": 37
      },
      {
        "ip": 97,
        "line": 38
      },
      {
        "ip": 105,
        "line": 42
      },
      {
        "ip": 109,
        "line": 44
      },
      {
        "ip": 113,
        "line": 45
      },
      {
        "ip": 120,
        "line": 46
      },
      {
        "ip": 136,
        "line": 51
      },
      {
        "ip": 141,
        "line": 52
      },
      {
        "ip": 148,
        "line": 55
      },
      {
        "ip": 155,
        "line": 58
      },
      {
        "ip": 158,
        "line": 59
      },
      {
        "ip": 168,
        "line": 64
      }
    ]
  },
  "compiler": {
    "name": "cashc",
    "version": "0.12.0"
  },
  "updatedAt": "2025-11-22T11:03:26.710Z"
}